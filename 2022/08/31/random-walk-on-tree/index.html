<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>树上随机游走问题 | AgOH's Coffeehouse</title><script>var config = {"hostname":"https://agoh.xyz","root":"/","preload":true,"path":"search.json"}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css" integrity="sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js" integrity="sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><link rel="stylesheet" href="/css/arknights.css"><link rel="stylesheet" href="//unpkg.com/@highlightjs/cdn-assets@11.4.0/styles/atom-one-dark-reasonable.min.css"><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.ttf");
}</style><script src="/js/utils.js"> </script><meta name="generator" content="Hexo 6.2.0"></head><body style="background-image:url(https://ak.hypergryph.com/assets/index/images/ak/pc/bk.jpg);"><main><header><nav><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><ol class="navContent"><li class="navItem search-header"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="数据检索" spellcheck="false" maxlength="50" type="text" id="search-input"></li><li class="navItem"><a href="/"><span class="navItemTitle">Home</span></a></li><li class="navItem"><a href="/archives/"><span class="navItemTitle">Archives</span></a></li><li class="navItem"><a href="/links/"><span class="navItemTitle">Links</span></a></li></ol></nav><div class="search-popup"><div id="search-result"></div></div></header><article><div id="post-bg"><div id="post-title"><h1>树上随机游走问题</h1><div id="post-info"><span>First Post:<span class="control"><time datetime="2022-08-31T08:37:43.000Z" id="date"> 2022-08-31</time></span></span><br><span>Last Update:<span class="control"><time datetime="2022-09-18T12:57:13.311Z" id="updated"> 2022-09-18</time></span></span><br><span>Word Count:<span class="control">&nbsp;708</span></span><br><span>Read Time:<span class="control">&nbsp;3min</span></span></div></div><hr><div id="post-content"><h2 id="需要用到的定义">需要用到的定义</h2>
<ul>
<li><span class="math inline">\(T=(V,E)\)</span>：所讨论的树</li>
<li><span class="math inline">\(d(u)\)</span>：<span class="math inline">\(u\)</span> 结点的度数</li>
<li><span class="math inline">\(w(u,v)\)</span>：<span class="math inline">\(u\)</span> 结点与 <span class="math inline">\(v\)</span> 结点之间的边的边权</li>
<li><span class="math inline">\(p_u\)</span>：<span class="math inline">\(u\)</span> 结点的父结点</li>
<li><span class="math inline">\({son}_u\)</span>：<span class="math inline">\(u\)</span> 结点的子结点集合</li>
<li><span class="math inline">\({sibling}_u\)</span>：<span class="math inline">\(u\)</span> 结点的兄弟结点集合</li>
</ul>
<h2 id="向父结点走的期望距离">向父结点走的期望距离</h2>
<p>设 <span class="math inline">\(f(u)\)</span> 代表 <span class="math inline">\(u\)</span> 结点走到其父结点 <span class="math inline">\(p_u\)</span> 的期望距离，则有：</p>
<p><span class="math display">\[f(u) = \cfrac{w(u,p_u) + \sum\limits_{v \in {son}_u}(w(u,v) + f(v) + f(u))}{d(u)}\]</span></p>
<p>化简如下：</p>
<p><span class="math display">\[
\begin{aligned}
    f(u) &amp;= \cfrac{w(u,p_u) + \sum\limits_{v \in {son}_u}(w(u,v) + f(v) + f(u))}{d(u)} \\
            &amp;= \cfrac{w(u,p_u) + \sum\limits_{v \in {son}_u}(w(u,v) + f(v)) + (d(u)-1)f(u)}{d(u)} \\
            &amp;= w(u,p_u) + \sum\limits_{v \in {son}_u}(w(u,v) + f(v)) \\
            &amp;= \sum\limits_{(u,t) \in E}w(u,t) + \sum\limits_{v \in {son}_u}f(v)
\end{aligned}
\]</span></p>
<p>分子中的前半部分代表直接走向了父结点，后半部分代表先走向了子结点再由子结点走回来然后再向父结点走；分母 <span class="math inline">\(d(u)\)</span> 代表从 <span class="math inline">\(u\)</span> 结点走向其任何邻接点的概率相同。</p>
<p>初始状态为 <span class="math inline">\(f(leaf) = 1\)</span>。</p>
<p>当树上所有边的边权都为 <span class="math inline">\(1\)</span> 时，上式可化为：</p>
<p><span class="math display">\[f(u) = d(u) + \sum\limits_{v \in {son}_u}f(v)\]</span></p>
<p>即 <span class="math inline">\(u\)</span> 子树的所有结点的度数和，也即 <span class="math inline">\(u\)</span> 子树大小的两倍 <span class="math inline">\(-1\)</span>（每个结点连向其父亲的边都有且只有一条，除 <span class="math inline">\(u\)</span> 与 <span class="math inline">\(p_u\)</span> 之间的边只有 <span class="math inline">\(1\)</span> 点度数的贡献外，每条边会产生 <span class="math inline">\(2\)</span> 点度数的贡献）。</p>
<h2 id="向子结点走的期望距离">向子结点走的期望距离</h2>
<p>设 <span class="math inline">\(g(u)\)</span> 代表 <span class="math inline">\(p_u\)</span> 结点走到其子结点 <span class="math inline">\(u\)</span> 的期望距离，则有：</p>
<p><span class="math display">\[g(u) = \cfrac{w(p_u,u) + \left(w(p_u,p_{p_u})+g(p_u)+g(u)\right) + \sum\limits_{s \in {sibling}_u}(w(p_u,s)+f(s)+g(u))}{d(p_u)}\]</span></p>
<p>分子中的第一部分代表直接走向了子结点 <span class="math inline">\(u\)</span>，第二部分代表先走向了父结点再由父结点走回来然后再向 <span class="math inline">\(u\)</span> 结点走，第三部分代表先走向 <span class="math inline">\(u\)</span> 结点的兄弟结点再由其走回来然后再向 <span class="math inline">\(u\)</span> 结点走；分母 <span class="math inline">\(d(u)\)</span> 代表从 <span class="math inline">\(u\)</span> 结点走向其任何邻接点的概率相同。</p>
<p>化简如下：</p>
<p><span class="math display">\[
\begin{aligned}
    g(u) &amp;= \cfrac{w(p_u,u) + \left(w(p_u,p_{p_u})+g(p_u)+g(u)\right) + \sum\limits_{s \in {sibling}_u}(w(p_u,s)+f(s)+g(u))}{d(p_u)} \\
         &amp;= \cfrac{w(p_u,u) + w(p_u,p_{p_u}) + g(p_u) + \sum\limits_{s \in {sibling}_u}\left(w(p_u,s)+f(s)\right)+(d(p_u)-1)g(u)}{d(p_u)} \\
         &amp;= w(p_u,u) + w(p_u,p_{p_u}) + g(p_u) + \sum\limits_{s \in {sibling}_u}(w(p_u,s)+f(s)) \\
         &amp;= \sum\limits_{(p_u,t) \in E}w(p_u,t) + g(p_u) + \sum\limits_{s \in {sibling}_u}f(s)
\end{aligned}
\]</span></p>
<p>初始状态为 <span class="math inline">\(g(root) = 0\)</span>。</p>
<p>当树上所有边的边权都为 <span class="math inline">\(1\)</span> 时，上式可化为：</p>
<p><span class="math display">\[g(u) = d(p_u) + g(p_u) + \sum\limits_{s \in {sibling}_u}f(s)\]</span></p>
<div id="paginator"></div></div><div id="post-footer"><div id="pages"><div id="footer-link" style="right: calc(50% - 1px);order: 1;border-right: 1px solid #fe2;padding-left: unset;max-width: calc(50% - 4px);"><a href="/2022/09/18/enumerate-binary-subsets/">← Next 使用位运算枚举二进制子集的巧妙方法</a></div><div id="footer-link" style="left: 50%;order: 0;border-left: 1px solid #fe2;padding-right: unset;max-width: calc(50% - 5px);"><a href="/2022/05/23/daily-problems/">每日刷题打卡 Prev →</a></div></div></div><details id="reward"><summary>打赏</summary><div id="alipay"><span>支付宝 | Alipay</span><br><img src="/img/Alipay.png"></div><div id="wechat"><span>微信 | WeChat</span><br><img src="/img/WeChat.png"></div></details><script src="https://giscus.app/client.js" data-repo="StableAgOH/stableagoh.github.io" data-repo-id="null" data-category="Announcements" data-category-id="DIC_kwDOHHhRBc4CO1AZ" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="dark" data-lang="zh-CN" crossorigin="anonymous" async></script></div><div id="bottom-btn"><a id="to-top" onClick="index.scrolltop();" title="to top" style="opacity: 0; display: none;">∧</a></div></article><div class="aside-box"><aside><div id="aside-top"><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a target="_blank" rel="noopener" href="https://space.bilibili.com/120174936">AgOH</a></h1><div id="description"><p>苛性银的咖啡屋</p></div><!--if page.published === undefined--><section id="total"><a id="total-archives" href="/archives"><span class="total-title">Archives Total:</span><span class="total-number">6</span></a><div id="total-tags"><span class="total-title">Tags:</span><span class="total-number">8</span></div><div id="total-categories"><span class="total-title">Categories:</span><span class="total-number">3</span></div></section></div><div id="aside-block"><div id="toc-div"><h1>INDEX</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E7%94%A8%E5%88%B0%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">1.</span> <span class="toc-text">需要用到的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%91%E7%88%B6%E7%BB%93%E7%82%B9%E8%B5%B0%E7%9A%84%E6%9C%9F%E6%9C%9B%E8%B7%9D%E7%A6%BB"><span class="toc-number">2.</span> <span class="toc-text">向父结点走的期望距离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%91%E5%AD%90%E7%BB%93%E7%82%B9%E8%B5%B0%E7%9A%84%E6%9C%9F%E6%9C%9B%E8%B7%9D%E7%A6%BB"><span class="toc-number">3.</span> <span class="toc-text">向子结点走的期望距离</span></a></li></ol></div></div></div><footer><nobr><span class="text-title">Dr.</span><span class="text-content">不分解的 AgOH</span></nobr><br><nobr><span class="text-title">官服ID</span><span class="text-content">951391786</span></nobr><br><nobr><span class="text-title">ICP</span><span class="text-content">辽ICP备2022005050号-2</span></nobr><br><text>published with <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a></text><text> Theme <a target="_blank" rel="noopener" href="https://github.com/Yue-plus/hexo-theme-arknights">Arknight</a></text><wbr><text>by <a target="_blank" rel="noopener" href="https://github.com/Yue-plus">Yue_plus</a></text></footer></aside></div></main><canvas id="canvas-dust"></canvas><script src="/js/search.js"></script><script>const reset=_=>{}</script><script src="//unpkg.com/@highlightjs/cdn-assets@11.4.0/highlight.min.js"></script><script src="/js/arknights.js"></script><script>document.addEventListener("load",reset())</script></body></html>